<div class="page-header">
    <div class="headings">
        <h1>Descriptions</h1>
        <h2>{{ vm.cycle.name }}</h2>
    </div>

    <div class="controls">
        <button type="button" id="save-products" class="carli-button" busy-click="vm.saveProducts()" ng-disabled="vm.noProductsHaveChanged() || vm.formIsInvalid()">Save Changes<i class="fa fa-floppy-o"></i></button>
    </div>
</div>

<section class="content" id="descriptions" cg-busy="vm.loadingPromise">
    <ul ng-repeat="(key, errors) in productForm.$error track by $index" class="descriptions__error-list">
        <li ng-repeat="error in errors" ng-if="key == 'maxlength'">
            {{ error.$name }} is too long
        </li>
    </ul>
    <form name="productForm" warn-if-unsaved>
        <ul class="product-list">
            <li class="product" ng-repeat="product in vm.products | orderBy:'name' track by product.id">
                <div class="column url">
                    <div class="name">{{ ::product.name }}</div>
                    <div class="url-group">
                        <div class="label">Product URL</div>
                        <input type="text" ng-model="product.productUrl" ng-change="vm.productChanged(product.id)" />
                    </div>
                </div>
                <div class="column description">
                    <div class="label">Product Description</div>
                    <textarea name="{{ product.name }}'s description" ng-model="product.description" ng-change="vm.productChanged(product.id)" ng-maxlength="vm.maxLength"></textarea>
                    <div class="character-count">Remaining characters: {{ vm.remainingCharacters(product, 'description') }}</div>
                </div>
                <div class="column comments">
                    <div class="label">Comments for Libraries</div>
                    <textarea name="{{ product.name }}'s comment" ng-model="product.comments" ng-change="vm.productChanged(product.id)" ng-maxlength="vm.maxLength"></textarea>
                    <div class="character-count">Remaining characters: {{ vm.remainingCharacters(product, 'comments') }}</div>
                </div>
            </li>
        </ul>
    </form>
</section>
